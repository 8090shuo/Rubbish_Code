# 深入浅出通信原理Python代码版

> 深入浅出通信原理是陈爱军的心血之作，于[通信人家园](http://www.txrjy.com/thread-394879-1-4.html)连载，此处仅作python代码笔记训练所用
> 陈老师的连载从多项式乘法讲起，一步一步引出卷积、傅立叶级数展开、旋转向量、三维频谱、IQ调制、数字调制等一系列通信原理知识

[TOC]

## 采样详解

> ### 模/数转换（ADC）
>
> > 模拟信号f(t) -- 采用抽样脉冲p(t) --> 抽样信号f_s(t) -- 量化编码 --->数字信号f[n]
> >
> > （ADC内部结构----连载149）
>
> ### 理想抽样
>
> > 时域上->模拟信号与抽样脉冲相乘得到抽样信号：$f(t)p(t)=f_s(t)$
> >
> > 频域上->模拟信号傅里叶变换与抽样信号傅里叶变换卷积的结果
> >
> > 抽样脉冲$p(t)=\sum_{n=-\infin}^{+\infin}\delta(t-nT_s)$
> >
> > 抽样脉冲频域$F[p(t)]=\sum_{k=-\infty}^{+\infty}2\pi c_k\delta(w-kw_0)=\frac{2\pi}{T_s}\sum_{k=-\infty}^{+\infty}\delta(w-kw_0)$
> >
> > 抽样脉冲频谱密度是一系列间隔为$\omega_0=\frac{2\pi}{T_s}$的强度为$\frac{2\pi}{T_s}$的冲激信号
> >
> > **因此在时域进行抽样，即在频域以采样频率为间隔对频谱作周期性延拓**
>
> ### 平顶采样
>
> > 采样输出$V_{采样}=f_s(t)=f(nT_s)\neq f(t)p(t)$
> >
> > 平顶采样=理想采样+脉冲成型滤波器（连载152）
>
> ![连载150ADC原理](http://download.txrjy.com/forum/month_1009/20100924_b581f505d52a16000e02BO0LEvnm9oQe.jpg)
>
> ### 脉冲成型滤波器：
>
> > 输入理想脉冲 $x(t)=f(t)p(t)=\sum_{n=-\infty}^{+\infty}f(nT_s)\delta(t-nT_s)$
> >
> > 输出平顶采样 $y(t)=x(t)*h(t)=\sum_{n=-\infty}^{+\infty}f(nT_s)h(t-nT_s)$
> >
> > 脉冲成型滤波器的单位冲激响应的傅里叶变换称为脉冲成型滤波器的频率响应
> >
> > ![连载157脉冲成型滤波器频谱](http://download.txrjy.com/forum/month_1010/20101001_4c2f0242f94c66d6c4a0HBw4prpzP02L.jpg)
> >
> > 频率响应$T_s sinc(T_sf)$=幅频响应+相频响应
> >
> > ```python
> > # 脉冲程序滤波器的频率响应|H(f)|=Ts*|sinc(Ts*f)|
> > f=np.arange(-30,30.1,0.1)
> > Ts=0.1
> > y=abs(Ts*np.sinc(Ts*f))
> > plt.plot(f,y)
> > plt.title("脉冲信号幅频响应",fontproperties='stsong')
> > plt.show()
> > ```
> >
> > ![连载158脉冲信号幅频响应](http://ww1.sinaimg.cn/large/70815d51ly1g668cklzlgj20ai079glq.jpg)
>
> ### 平顶采样信号恢复
>
> > （连载180）
> >
> > 由于通过频率响应是H(f)的脉冲成型滤波器可得平顶抽样信号频谱，因此接收端也通过1/H(f)的滤波器即可得到理想抽样信号频谱，再通过理想低通滤波器即可恢复原模拟信号
> >
> > 若没通过频率响应是1/H(f)的滤波器，会造成孔径失真的现象
>
> ### 采样用途
>
> > PCM系统（连载160）：
> >
> > 语音信号以8kHz采样，每个采样值进行量化编码成8bit，传输一路语音信号需64kbps
>
> ### 奈奎斯特采样定理
>
> > 从 抽样信号中无失真恢复原信号，抽样频率需要大于2倍信号最高频率
> >
> > 对 频率kfs+f的余弦信号进行采样频率fs的采样，恢复出频率f的余弦信号（连载164、165）
> >
> > 因为DAC通常选择接近零频的混淆频率转换成模拟信号
>
> ### 折叠频率
>
> > 把采样频率的一半(fs/2)称为折叠频率，因为频率高于fs/2低于-fs/2都会折叠到区间[-fs/2, fs/2]
> >
> > 因此采用抗混叠滤波器（低通滤波器通带[-fs/2, fs/2]）将区间外的信号滤去防止混叠
>
> ### 频域理解采样恢复信号：
>
> > 在时域进行抽样，即在频域以采样频率为间隔对频谱作周期性延拓，即得到抽样信号后进行傅里叶变换，再通过低通滤波器将周期延拓后的频谱的一个周期取出，再进行逆傅里叶变换即可
>
> ![连载178](http://download.txrjy.com/forum/month_1010/20101025_90264c6a467cf1ebd14570oqWEzMMsvE.jpg)
>
> ### 时域理解采样恢复信号：
>
> > 抽样信号卷积sinc信号（低通滤波器的单位冲激响应）所得即原始模拟信号
> >
> > 抽样信号的多个冲激以抽样时间间隔依次送入低通滤波器，低通滤波器以抽样时间间隔输出多个sinc信号，其叠加结果是原始模拟信号
>
> ### 带通信号采样定理
>
> > (连载182)
> >
> > 中心频率是$f_0$，带宽是B的带通信号，其截至频率分别是$f_H=f_0+B/2$和$f_L=f_0-B/2$
> >
> > 则采样频率应满足$\frac{2f_H}{m}\leq f_s\leq \frac{2f_L}{m-1}$
> >
> > 其中：m=1,2,...,max, max指的是不大于f_H/B的最大整数
> >
> > 当信号频率正好是带宽的整数倍时，其最低采样频率正好是带宽2倍，其余情况均大于2倍带宽
> >
> > 但是当信号最高频率远大于带宽时，只需要以略大于2倍带宽的采样频率进行采样即可
> >
> > 因此设计信号时往往将信号最高频率设计成带宽的整数倍（连载189）
> >
> > 由此需要抗混叠滤波器（带通滤波器通带带宽B）将所需频带外的信号滤除

要实现无码间串扰，所需的最小带宽只要码元速率的一半

## 相位相关

> 连载212、213：
>
> 相位失真——信号若要无失真通过延时系统，不同频率成分的相移必须与频率成正比
>
> 无失真延时系统的相频曲线应当是一条经过原点，斜率是-t0的直线
>
> 波的干涉：若频率相同相位差恒定且震动方向相同的波在媒介中相遇，则会在叠加区域某些位置震动持续加强（相长干涉），某些区域始终减弱甚至抵消（相消干涉）。
>
> 相干解调/非相干解调：接收机需要一个与发送载波同频同相的载波副本进行解调称相干解调，只需要同频的副本则称非相干解调
>
> 载波副本通过同步电路获取，同步电路核心是锁相环PLL（Phase-Locked Loop）

## 无码间串扰

> 奈奎斯特第一准则：
>
> 在带宽是B的信道传送码元时，若想实现无码间串扰，码元速率R不大于两倍带宽。若使用奈奎斯特速率2B传输码元，必须使用带宽是B的理想低通滤波器对数据进行滤波。
>
> 因此基带系统**单位频带利用率**：$\eta=R/B=2Band/Hz$
>
> 但由于理想低通滤波器时域的单位冲激响应是sinc信号，衰减较慢，当时间同步不精确时易造成较大码间串扰，因此采用升余弦滚降滤波器
>
> 若以码元传输速率最大速率2B传输，升余弦滚降滤波器所需信道带宽是2B
>
> ```python
> 
> # 连载221，222 升余弦滚降滤波器与理想低通滤波器频域频率响应与时域单位冲激响应对比
> plt.subplot(2,1,1)
> f=np.arange(-1.0,1.01,0.01)
> x = [-1.5,-0.5,-0.5,0.5,1.5]
> y = [0,0,1,1,0]
> plt.plot(x,y,drawstyle='steps-pre',label='low_pass_filter')
> y2 = 0.5*(1+np.cos(np.pi*f))
> plt.plot(f,y2,label='raised_cosine_FIR')
> plt.title('滤波器频率响应',fontproperties='stsong')
> plt.legend()
> plt.show()
> 
> # 单位冲激响应,B=0.5
> plt.subplot(2,1,2)
> t = np.arange(-4,4.01,0.01)
> y1 = np.sinc(t)*np.cos(np.pi*t)/(1-4*t*t)
> plt.plot(t,y1,color='r',label='raised_cosine_FIR')
> y2 = np.sinc(t)
> plt.plot(t,y2,label='low_pass_filter')
> plt.title('滤波器单位冲激响应',fontproperties='stsong')
> plt.legend()
> plt.plot()
> plt.tight_layout()
> ```
>
> ![连载221](http://ww1.sinaimg.cn/large/70815d51ly1g673rdskdrj20ac03zjrd.jpg)
>
> ![连载222](http://ww1.sinaimg.cn/large/70815d51ly1g673qsyrowj20bs04d0sv.jpg)
>
> 当滚降系数a=0时是理想低通滤波器，占用信道带宽最小，频带利用率最高，但易码间串扰
>
> 脉冲成型滤波器/基带滤波器（BBF）：就是指升余弦滚降滤波器或者理想低通滤波器
>
> 若使用升余弦滚降滤波器，滚降系数是a，则基带带宽B=R(1+a)/2
>
> 基带带宽有基带信号速率与脉冲成型滤波器相关（连载231)
>
> 双边带调制的频带传输系统的频带带宽是基带带宽的2倍（连载233）
>
> 单边带调制是按照双边带调制方式调制但只发送一个边带，因此只占用一半带宽

已调信号通过非线性功率放大器会失真，且失真程度与频带信号的包络起伏有关，包络起伏越大失真越大。

因为I(t)与Q(t)同时过零时信号包络$\sqrt{I^2(t)+Q^2(t)}$会过零，因此只需错开半个码元信号便不再过零，这便是OQPSK设计思想，从QPSK的非恒包络发展为OQPSK的恒包络，便于使用非线性功放。



> 

